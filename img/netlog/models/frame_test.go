package models

import (
	"testing"

	"github.com/stretchr/testify/require"
)

var sampleBytes = []byte{0x00, 0x00, 0x00, 0x01, 0x00, 0x06, 0x02, 0x42, 0x0a, 0x01, 0x00, 0x51, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00, 0x00, 0x28, 0x79, 0x97, 0x40, 0x00, 0x40, 0x06, 0xac, 0x89, 0x0a, 0x01, 0x00, 0x51, 0x0a, 0x01, 0x00, 0x5d, 0xdd, 0x62, 0x13, 0x88, 0x51, 0xc4, 0xa9, 0x8b, 0x00, 0x00, 0x00, 0x00, 0x50, 0x04, 0x00, 0x00, 0xae, 0xf6, 0x00, 0x00}

func TestMACAddressString(t *testing.T) {
	m := MACAddress([]byte{0x02, 0x42, 0x0a, 0x01, 0x00, 0x51})
	require.Equal(t, "02:42:0a:01:00:51", m.String())
}

func TestIEEEFrameSource(t *testing.T) {
	f := IEEEFrame(sampleBytes)
	require.Equal(t, MACAddress([]byte{0x02, 0x42, 0x0a, 0x01, 0x00, 0x51}), f.Source())
}

func TestIEEEFrameDest(t *testing.T) {
	f := IEEEFrame(sampleBytes)
	require.Equal(t, MACAddress([]byte{0x00, 0x00, 0x00, 0x01, 0x00, 0x06}), f.Dest())
}
